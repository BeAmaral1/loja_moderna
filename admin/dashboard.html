<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Dashboard Administrativo - Moda Elegante</title>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/admin.css">
    
    <!-- Admin Loading System Inline -->
    <style>
        .admin-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.95), rgba(29, 78, 216, 0.95));
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
        }

        .admin-loading.show {
            opacity: 1;
            visibility: visible;
        }

        .admin-loading-content {
            text-align: center;
            padding: 3rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            width: 90%;
        }

        .admin-loading-spinner {
            width: 80px;
            height: 80px;
            margin: 0 auto 2rem;
            border: 6px solid rgba(37, 99, 235, 0.2);
            border-top: 6px solid #2563eb;
            border-radius: 50%;
            animation: adminSpin 1s linear infinite;
        }

        .admin-loading-title {
            color: #1f2937;
            font-weight: 700;
            margin-bottom: 0.5rem;
            font-size: 1.5rem;
        }

        .admin-loading-text {
            color: #6b7280;
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        .admin-loading-progress {
            width: 100%;
            height: 6px;
            background: rgba(37, 99, 235, 0.2);
            border-radius: 3px;
            overflow: hidden;
        }

        .admin-loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #2563eb, #3b82f6);
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
        }

        @keyframes adminSpin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="css/admin.css" rel="stylesheet">
    <style>
        /* Estilos específicos do dashboard - complementam admin.css */
        .mobile-toggle {
            display: none;
        }
        
        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
            }
            
            .topbar {
                padding: 1rem;
                margin: -1rem -1rem 1rem -1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h4 class="fw-bold mb-0">
                <i class="fas fa-gem me-2"></i>Moda Elegante
            </h4>
            <small class="opacity-75">Painel Administrativo</small>
        </div>
        
        <nav class="sidebar-menu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#dashboard" onclick="showSection('dashboard')">
                        <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#vendas" onclick="showSection('vendas')">
                        <i class="fas fa-shopping-cart me-2"></i>Vendas
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#pagamentos" onclick="showSection('pagamentos')">
                        <i class="fas fa-credit-card me-2"></i>Pagamentos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#produtos" onclick="showSection('produtos')">
                        <i class="fas fa-box me-2"></i>Produtos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#clientes" onclick="showSection('clientes')">
                        <i class="fas fa-users me-2"></i>Clientes
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#relatorios" onclick="showSection('relatorios')">
                        <i class="fas fa-chart-bar me-2"></i>Relatórios
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#configuracoes" onclick="showSection('configuracoes')">
                        <i class="fas fa-cog me-2"></i>Configurações
                    </a>
                </li>
            </ul>
            
            <!-- Botão de Logout -->
            <div class="sidebar-footer mt-auto p-3">
                <button class="btn btn-outline-danger w-100" onclick="logout()" title="Sair do painel">
                    <i class="fas fa-sign-out-alt me-2"></i>Sair
                </button>
            </div>
        </nav>
    </div>

    <!-- Overlay para mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Topbar -->
        <div class="topbar">
            <div class="d-flex align-items-center">
                <button class="btn btn-link mobile-toggle me-3 p-0" onclick="toggleSidebar()">
                    <i class="fas fa-bars fs-4"></i>
                </button>
                <h2 class="mb-0">Dashboard</h2>
            </div>
            <button class="btn btn-logout" onclick="logout()">
                <i class="fas fa-sign-out-alt me-2"></i>Sair
            </button>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="content-section">
            <!-- Stats Cards -->
            <div class="row mb-4">
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="stats-card">
                        <div class="stats-icon primary">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h3 class="fw-bold mb-1" id="totalVendas">R$ 0,00</h3>
                        <p class="text-muted mb-0">Vendas Hoje</p>
                        <small class="text-success">
                            <i class="fas fa-arrow-up me-1"></i>+12% vs ontem
                        </small>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="stats-card">
                        <div class="stats-icon success">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h3 class="fw-bold mb-1" id="totalPedidos">0</h3>
                        <p class="text-muted mb-0">Pedidos Hoje</p>
                        <small class="text-success">
                            <i class="fas fa-arrow-up me-1"></i>+8% vs ontem
                        </small>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="stats-card">
                        <div class="stats-icon warning">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h3 class="fw-bold mb-1" id="pedidosPendentes">0</h3>
                        <p class="text-muted mb-0">Pendentes</p>
                        <small class="text-warning">
                            <i class="fas fa-exclamation-triangle me-1"></i>Requer atenção
                        </small>
                    </div>
                </div>
                
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="stats-card">
                        <div class="stats-icon danger">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3 class="fw-bold mb-1" id="totalClientes">0</h3>
                        <p class="text-muted mb-0">Clientes</p>
                        <small class="text-success">
                            <i class="fas fa-arrow-up me-1"></i>+5 novos hoje
                        </small>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="row mb-4">
                <div class="col-lg-8">
                    <div class="chart-container">
                        <h5 class="fw-bold mb-3">Vendas dos Últimos 7 Dias</h5>
                        <div style="position: relative; height: 300px; width: 100%;">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="chart-container">
                        <h5 class="fw-bold mb-3">Métodos de Pagamento</h5>
                        <div style="position: relative; height: 300px; width: 100%;">
                            <canvas id="paymentChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Orders -->
            <div class="table-container">
                <div class="table-header">
                    <h5 class="fw-bold mb-0">Pedidos Recentes</h5>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>Pagamento</th>
                                <th>Data</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="recentOrdersTable">
                            <!-- Dados serão inseridos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Outras seções serão adicionadas aqui -->
        <!-- Seção de Produtos -->
        <div id="produtos-section" class="content-section" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3>Gerenciamento de Produtos</h3>
                <button class="btn btn-primary" onclick="showAddProductModal()">
                    <i class="fas fa-plus me-2"></i>Novo Produto
                </button>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="fw-bold mb-0">Lista de Produtos</h5>
                        <div class="d-flex gap-2">
                            <input type="text" class="form-control" placeholder="Buscar produtos..." id="searchProducts" style="width: 250px;">
                            <select class="form-select" id="filterCategory" style="width: 150px;">
                                <option value="">Todas as categorias</option>
                                <option value="masculino">Masculino</option>
                                <option value="feminino">Feminino</option>
                                <option value="acessorios">Acessórios</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Imagem</th>
                                <th>Nome</th>
                                <th>Categoria</th>
                                <th>Preço</th>
                                <th>Estoque</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="productsTable">
                            <!-- Produtos serão carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Seção de Vendas -->
        <div id="vendas-section" class="content-section" style="display: none;">
            <h3>Gestão de Vendas</h3>
            
            <!-- Stats Cards para Vendas -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-icon success">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="vendasMes">R$ 0,00</h4>
                        <p class="text-muted mb-0">Vendas do Mês</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-icon primary">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="pedidosMes">0</h4>
                        <p class="text-muted mb-0">Pedidos do Mês</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-icon warning">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="ticketMedio">R$ 0,00</h4>
                        <p class="text-muted mb-0">Ticket Médio</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card">
                        <div class="stats-icon danger">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="conversao">0%</h4>
                        <p class="text-muted mb-0">Taxa de Conversão</p>
                    </div>
                </div>
            </div>

            <!-- Tabela de Pedidos -->
            <div class="table-container">
                <div class="table-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="fw-bold mb-0">Todos os Pedidos</h5>
                        <div class="d-flex gap-2">
                            <select class="form-select" id="filterStatus" style="width: 150px;">
                                <option value="">Todos os status</option>
                                <option value="Pago">Pago</option>
                                <option value="Pendente">Pendente</option>
                                <option value="Cancelado">Cancelado</option>
                                <option value="Processando">Processando</option>
                            </select>
                            <input type="date" class="form-control" id="filterDate" style="width: 150px;">
                        </div>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>Produtos</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>Pagamento</th>
                                <th>Data</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTable">
                            <!-- Pedidos serão carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Seção de Pagamentos -->
        <div id="pagamentos-section" class="content-section" style="display: none;">
            <h3>Gestão de Pagamentos</h3>
            
            <!-- Stats Cards para Pagamentos -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="stats-card">
                        <div class="stats-icon success">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="pagamentosAprovados">R$ 0,00</h4>
                        <p class="text-muted mb-0">Pagamentos Aprovados</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stats-card">
                        <div class="stats-icon warning">
                            <i class="fas fa-clock"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="pagamentosPendentes">R$ 0,00</h4>
                        <p class="text-muted mb-0">Pagamentos Pendentes</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stats-card">
                        <div class="stats-icon danger">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <h4 class="fw-bold mb-1" id="pagamentosRecusados">R$ 0,00</h4>
                        <p class="text-muted mb-0">Pagamentos Recusados</p>
                    </div>
                </div>
            </div>

            <!-- Tabela de Transações -->
            <div class="table-container">
                <div class="table-header">
                    <h5 class="fw-bold mb-0">Transações Recentes</h5>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID Transação</th>
                                <th>Pedido</th>
                                <th>Cliente</th>
                                <th>Método</th>
                                <th>Valor</th>
                                <th>Status</th>
                                <th>Data</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTable">
                            <!-- Transações serão carregadas via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Seção de Clientes -->
        <div id="clientes-section" class="content-section" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3>Gerenciamento de Clientes</h3>
                <button class="btn btn-primary" onclick="exportClients()">
                    <i class="fas fa-download me-2"></i>Exportar Lista
                </button>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="fw-bold mb-0">Lista de Clientes</h5>
                        <input type="text" class="form-control" placeholder="Buscar clientes..." id="searchClients" style="width: 250px;">
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Telefone</th>
                                <th>Pedidos</th>
                                <th>Total Gasto</th>
                                <th>Cadastro</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody id="clientsTable">
                            <!-- Clientes serão carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Seção de Relatórios -->
        <div id="relatorios-section" class="content-section" style="display: none;">
            <h3>Relatórios e Análises</h3>
            
            <!-- Filtros de Período -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-body">
                            <h5>Período de Análise</h5>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="form-label">Data Inicial</label>
                                    <input type="date" class="form-control" id="reportStartDate">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Data Final</label>
                                    <input type="date" class="form-control" id="reportEndDate">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Período</label>
                                    <select class="form-select" id="reportPeriod">
                                        <option value="7">Últimos 7 dias</option>
                                        <option value="30">Últimos 30 dias</option>
                                        <option value="90">Últimos 90 dias</option>
                                        <option value="365">Último ano</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">&nbsp;</label>
                                    <button class="btn btn-primary d-block" onclick="generateReport()">
                                        <i class="fas fa-chart-bar me-2"></i>Gerar Relatório
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gráficos de Relatórios -->
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="chart-container">
                        <h5 class="fw-bold mb-3">Vendas por Período</h5>
                        <canvas id="reportSalesChart" height="300"></canvas>
                    </div>
                </div>
                <div class="col-lg-6 mb-4">
                    <div class="chart-container">
                        <h5 class="fw-bold mb-3">Produtos Mais Vendidos</h5>
                        <canvas id="reportProductsChart" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Seção de Configurações -->
        <div id="configuracoes-section" class="content-section" style="display: none;">
            <h3>Configurações do Sistema</h3>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Configurações da Loja</h5>
                        </div>
                        <div class="card-body">
                            <form id="storeConfigForm">
                                <div class="mb-3">
                                    <label class="form-label">Nome da Loja</label>
                                    <input type="text" class="form-control" id="storeName" value="Moda Elegante">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Email de Contato</label>
                                    <input type="email" class="form-control" id="storeEmail" value="contato@modaelegante.com">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Telefone</label>
                                    <input type="text" class="form-control" id="storePhone" value="(11) 99999-9999">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Endereço</label>
                                    <textarea class="form-control" id="storeAddress" rows="3">Rua das Flores, 123 - Centro - São Paulo/SP</textarea>
                                </div>
                                <button type="submit" class="btn btn-primary">Salvar Configurações</button>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5 class="mb-0">Configurações de Pagamento</h5>
                        </div>
                        <div class="card-body">
                            <form id="paymentConfigForm">
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="enablePix" checked>
                                        <label class="form-check-label" for="enablePix">
                                            Habilitar PIX
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="enableCard" checked>
                                        <label class="form-check-label" for="enableCard">
                                            Habilitar Cartão de Crédito
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="enableBoleto">
                                        <label class="form-check-label" for="enableBoleto">
                                            Habilitar Boleto
                                        </label>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Taxa de Entrega (R$)</label>
                                    <input type="number" class="form-control" id="deliveryFee" value="15.00" step="0.01">
                                </div>
                                <button type="submit" class="btn btn-primary">Salvar Configurações</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="../assets/js/admin-dashboard.js" defer></script>
    
    <script>
        // Demonstração do loading administrativo
        document.addEventListener('DOMContentLoaded', function() {
            // Loading inicial da página
            showAdminLoading('Carregando Dashboard...', 'Buscando dados do sistema', true);
            
            setTimeout(() => {
                hideAdminLoading();
            }, 2000);
            
            // Adicionar loading aos botões de ação
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    if (this.textContent.includes('Salvar') || this.textContent.includes('Atualizar')) {
                        e.preventDefault();
                        showAdminLoading('Salvando...', 'Processando alterações', true);
                        setTimeout(() => {
                            hideAdminLoading();
                            alert('Dados salvos com sucesso! (Demo)');
                        }, 2500);
                    }
                });
            });
        });
    </script>
    
    <script>
        class AdminDashboard {
            constructor() {
                this.checkAuthentication();
                this.initializeCharts();
                this.loadDashboardData();
                this.setupEventListeners();
            }

            checkAuthentication() {
                // Comentar verificação de autenticação para desenvolvimento
                // const session = localStorage.getItem('adminSession');
                // if (!session) {
                //     window.location.href = 'login.html';
                //     return;
                // }

                // const sessionData = JSON.parse(session);
                // if (sessionData.expires < Date.now()) {
                //     localStorage.removeItem('adminSession');
                //     window.location.href = 'login.html';
                //     return;
                // }
            }

            setupEventListeners() {
                // Auto-refresh data every 5 minutes
                setInterval(() => {
                    this.loadDashboardData();
                }, 5 * 60 * 1000);
            }

            async loadDashboardData() {
                // Simular dados para desenvolvimento
                const mockData = {
                    total_vendas_hoje: 2450.80,
                    total_pedidos_hoje: 12,
                    pedidos_pendentes: 3,
                    total_clientes: 156,
                    recent_orders: [
                        {
                            id: 1001,
                            cliente: 'João Silva',
                            valor: 129.90,
                            status: 'Pago',
                            pagamento: 'PIX',
                            data: '2024-01-15T10:30:00'
                        },
                        {
                            id: 1002,
                            cliente: 'Maria Santos',
                            valor: 249.90,
                            status: 'Pendente',
                            pagamento: 'Cartão',
                            data: '2024-01-15T11:45:00'
                        },
                        {
                            id: 1003,
                            cliente: 'Pedro Costa',
                            valor: 189.50,
                            status: 'Pago',
                            pagamento: 'PIX',
                            data: '2024-01-15T14:20:00'
                        }
                    ]
                };
                
                this.updateStats(mockData);
                this.updateRecentOrders(mockData.recent_orders);
            }

            updateStats(data) {
                document.getElementById('totalVendas').textContent = 
                    new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' })
                    .format(data.total_vendas_hoje || 0);
                
                document.getElementById('totalPedidos').textContent = data.total_pedidos_hoje || 0;
                document.getElementById('pedidosPendentes').textContent = data.pedidos_pendentes || 0;
                document.getElementById('totalClientes').textContent = data.total_clientes || 0;
            }

            updateRecentOrders(orders) {
                const tbody = document.getElementById('recentOrdersTable');
                tbody.innerHTML = '';

                orders.forEach(order => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>#${order.id}</td>
                        <td>${order.cliente}</td>
                        <td>${new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(order.valor)}</td>
                        <td><span class="badge bg-${this.getStatusColor(order.status)}">${order.status}</span></td>
                        <td>${order.pagamento}</td>
                        <td>${new Date(order.data).toLocaleDateString('pt-BR')}</td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary" onclick="viewOrder('${order.id}')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }

            getStatusColor(status) {
                const colors = {
                    'Pago': 'success',
                    'Pendente': 'warning',
                    'Cancelado': 'danger',
                    'Processando': 'info'
                };
                return colors[status] || 'secondary';
            }

            initializeCharts() {
                // Destruir gráficos existentes se houver
                if (this.salesChart) {
                    this.salesChart.destroy();
                }
                if (this.paymentChart) {
                    this.paymentChart.destroy();
                }

                // Aguardar DOM estar pronto
                setTimeout(() => {
                    // Gráfico de Vendas
                    const salesCtx = document.getElementById('salesChart');
                    if (salesCtx) {
                        // Definir tamanho fixo do canvas
                        salesCtx.style.width = '100%';
                        salesCtx.style.height = '300px';
                        
                        this.salesChart = new Chart(salesCtx.getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                                datasets: [{
                                    label: 'Vendas (R$)',
                                    data: [1200, 1900, 3000, 5000, 2000, 3000, 4500],
                                    borderColor: '#2563eb',
                                    backgroundColor: 'rgba(37, 99, 235, 0.1)',
                                    tension: 0.4,
                                    fill: true,
                                    pointRadius: 4,
                                    pointHoverRadius: 6
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                interaction: {
                                    intersect: false,
                                    mode: 'index'
                                },
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    x: {
                                        grid: {
                                            display: false
                                        }
                                    },
                                    y: {
                                        beginAtZero: true,
                                        grid: {
                                            color: 'rgba(0,0,0,0.1)'
                                        },
                                        ticks: {
                                            callback: function(value) {
                                                return 'R$ ' + value.toLocaleString('pt-BR');
                                            },
                                            maxTicksLimit: 6
                                        }
                                    }
                                },
                                elements: {
                                    line: {
                                        borderWidth: 2
                                    }
                                }
                            }
                        });
                    }

                    // Gráfico de Métodos de Pagamento
                    const paymentCtx = document.getElementById('paymentChart');
                    if (paymentCtx) {
                        // Definir tamanho fixo do canvas
                        paymentCtx.style.width = '100%';
                        paymentCtx.style.height = '300px';
                        
                        this.paymentChart = new Chart(paymentCtx.getContext('2d'), {
                            type: 'doughnut',
                            data: {
                                labels: ['PIX', 'Cartão', 'Boleto'],
                                datasets: [{
                                    data: [45, 35, 20],
                                    backgroundColor: ['#10b981', '#2563eb', '#f59e0b'],
                                    borderWidth: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    }
                                }
                            }
                        });
                    }
                }, 100);
            }
        }

        function showSection(sectionName) {
            // Esconder todas as seções
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });

            // Mostrar seção selecionada
            document.getElementById(sectionName + '-section').style.display = 'block';

            // Atualizar menu ativo
            document.querySelectorAll('.sidebar-menu .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');

            // Atualizar título
            const titles = {
                'dashboard': 'Dashboard',
                'vendas': 'Vendas',
                'pagamentos': 'Pagamentos',
                'produtos': 'Produtos',
                'clientes': 'Clientes',
                'relatorios': 'Relatórios',
                'configuracoes': 'Configurações'
            };
            // document.getElementById('pageTitle').textContent = titles[sectionName];
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('show');
            overlay.classList.toggle('show');
        }

        function logout() {
            if (confirm('Deseja realmente sair?')) {
                localStorage.removeItem('adminSession');
                window.location.href = 'login.html';
            }
        }

        function viewOrder(orderId) {
            alert('Visualizar pedido #' + orderId);
        }

        // ===== FUNÇÕES DE PRODUTOS =====
        function showAddProductModal() {
            // Criar modal dinâmico para adicionar produto
            const modalHtml = `
                <div class="modal fade" id="addProductModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Novo Produto</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <form id="addProductForm">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Nome do Produto</label>
                                                <input type="text" class="form-control" id="productName" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Categoria</label>
                                                <select class="form-select" id="productCategory" required>
                                                    <option value="">Selecione...</option>
                                                    <option value="masculino">Masculino</option>
                                                    <option value="feminino">Feminino</option>
                                                    <option value="acessorios">Acessórios</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Preço (R$)</label>
                                                <input type="number" class="form-control" id="productPrice" step="0.01" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Estoque</label>
                                                <input type="number" class="form-control" id="productStock" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Descrição</label>
                                        <textarea class="form-control" id="productDescription" rows="3"></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">URL da Imagem</label>
                                        <input type="url" class="form-control" id="productImage" placeholder="https://...">
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                <button type="button" class="btn btn-primary" onclick="saveProduct()">Salvar Produto</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Remover modal existente se houver
            const existingModal = document.getElementById('addProductModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Adicionar modal ao DOM
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            // Mostrar modal
            const modal = new bootstrap.Modal(document.getElementById('addProductModal'));
            modal.show();
        }

        function saveProduct() {
            const form = document.getElementById('addProductForm');
            const formData = new FormData(form);
            
            const productData = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value),
                description: document.getElementById('productDescription').value,
                image: document.getElementById('productImage').value
            };
            
            // Validação básica
            if (!productData.name || !productData.category || !productData.price || !productData.stock) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            // Simular salvamento
            console.log('Salvando produto:', productData);
            alert('Produto salvo com sucesso!');
            
            // Fechar modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('addProductModal'));
            modal.hide();
            
            // Recarregar lista de produtos
            loadProducts();
        }

        function loadProducts() {
            // Simular carregamento de produtos
            const mockProducts = [
                {
                    id: 1,
                    name: 'Camisa Social Premium',
                    category: 'masculino',
                    price: 129.90,
                    stock: 15,
                    status: 'Ativo',
                    image: 'https://via.placeholder.com/50x50'
                },
                {
                    id: 2,
                    name: 'Calça Jeans Premium',
                    category: 'masculino',
                    price: 159.90,
                    stock: 8,
                    status: 'Ativo',
                    image: 'https://via.placeholder.com/50x50'
                },
                {
                    id: 3,
                    name: 'Blazer Masculino Slim',
                    category: 'masculino',
                    price: 249.90,
                    stock: 3,
                    status: 'Ativo',
                    image: 'https://via.placeholder.com/50x50'
                }
            ];
            
            const tbody = document.getElementById('productsTable');
            tbody.innerHTML = '';
            
            mockProducts.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><img src="${product.image}" alt="${product.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 8px;"></td>
                    <td>${product.name}</td>
                    <td><span class="badge bg-info">${product.category}</span></td>
                    <td>R$ ${product.price.toFixed(2)}</td>
                    <td>${product.stock}</td>
                    <td><span class="badge bg-success">${product.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editProduct(${product.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteProduct(${product.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function editProduct(id) {
            alert('Editar produto ID: ' + id);
        }

        function deleteProduct(id) {
            if (confirm('Deseja realmente excluir este produto?')) {
                alert('Produto excluído com sucesso!');
                loadProducts();
            }
        }

        // ===== FUNÇÕES DE CLIENTES =====
        function loadClients() {
            const mockClients = [
                {
                    id: 1,
                    name: 'João Silva',
                    email: 'joao@email.com',
                    phone: '(11) 99999-9999',
                    orders: 5,
                    totalSpent: 1250.00,
                    registerDate: '2024-01-15'
                },
                {
                    id: 2,
                    name: 'Maria Santos',
                    email: 'maria@email.com',
                    phone: '(11) 88888-8888',
                    orders: 3,
                    totalSpent: 890.50,
                    registerDate: '2024-02-20'
                }
            ];
            
            const tbody = document.getElementById('clientsTable');
            tbody.innerHTML = '';
            
            mockClients.forEach(client => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#${client.id}</td>
                    <td>${client.name}</td>
                    <td>${client.email}</td>
                    <td>${client.phone}</td>
                    <td>${client.orders}</td>
                    <td>R$ ${client.totalSpent.toFixed(2)}</td>
                    <td>${new Date(client.registerDate).toLocaleDateString('pt-BR')}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewClient(${client.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function viewClient(id) {
            alert('Visualizar cliente ID: ' + id);
        }

        function exportClients() {
            alert('Exportando lista de clientes...');
        }

        // ===== FUNÇÕES DE RELATÓRIOS =====
        function generateReport() {
            const startDate = document.getElementById('reportStartDate').value;
            const endDate = document.getElementById('reportEndDate').value;
            const period = document.getElementById('reportPeriod').value;
            
            alert(`Gerando relatório do período: ${startDate} a ${endDate}`);
            
            // Simular dados do relatório
            updateReportCharts();
        }

        function updateReportCharts() {
            // Destruir gráficos existentes se houver
            if (window.reportSalesChart) {
                window.reportSalesChart.destroy();
            }
            if (window.reportProductsChart) {
                window.reportProductsChart.destroy();
            }
            
            setTimeout(() => {
                // Gráfico de vendas por período
                const reportSalesCtx = document.getElementById('reportSalesChart');
                if (reportSalesCtx) {
                    window.reportSalesChart = new Chart(reportSalesCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                            datasets: [{
                                label: 'Vendas (R$)',
                                data: [12000, 19000, 15000, 25000, 22000, 30000],
                                backgroundColor: 'rgba(37, 99, 235, 0.8)'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
                
                // Gráfico de produtos mais vendidos
                const reportProductsCtx = document.getElementById('reportProductsChart');
                if (reportProductsCtx) {
                    window.reportProductsChart = new Chart(reportProductsCtx.getContext('2d'), {
                        type: 'pie',
                        data: {
                            labels: ['Camisas', 'Calças', 'Blazers', 'Acessórios'],
                            datasets: [{
                                data: [30, 25, 20, 25],
                                backgroundColor: ['#2563eb', '#10b981', '#f59e0b', '#ef4444']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
            }, 200);
        }

        // Sistema de Loading Global
        window.AdminLoading = {
            showLoading: function(title = 'Carregando...', text = 'Aguarde um momento') {
                // Criar elemento de loading se não existir
                if (!document.getElementById('admin-loading')) {
                    const loadingHTML = `
                        <div id="admin-loading" class="admin-loading">
                            <div class="admin-loading-content">
                                <div class="admin-loading-spinner"></div>
                                <h4 class="admin-loading-title" id="admin-loading-title">${title}</h4>
                                <p class="admin-loading-text" id="admin-loading-text">${text}</p>
                                <div class="admin-loading-progress">
                                    <div class="admin-loading-progress-bar" id="admin-loading-progress-bar"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    document.body.insertAdjacentHTML('beforeend', loadingHTML);
                }
                
                // Atualizar conteúdo
                const titleEl = document.getElementById('admin-loading-title');
                const textEl = document.getElementById('admin-loading-text');
                if (titleEl) titleEl.textContent = title;
                if (textEl) textEl.textContent = text;
                
                // Mostrar loading
                const loading = document.getElementById('admin-loading');
                if (loading) {
                    loading.classList.add('show');
                }
            },

            hideLoading: function() {
                const loading = document.getElementById('admin-loading');
                if (loading) {
                    loading.classList.remove('show');
                }
            },

            updateProgress: function(percentage) {
                const progressBar = document.getElementById('admin-loading-progress-bar');
                if (progressBar) {
                    progressBar.style.width = percentage + '%';
                }
            }
        };

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar loading inicial
            AdminLoading.showLoading('Carregando Dashboard...', 'Inicializando painel administrativo');
            
            setTimeout(() => {
                new AdminDashboard();
                
                // Carregar dados iniciais das seções
                loadProducts();
                loadClients();
                
                // Esconder loading após carregamento
                AdminLoading.hideLoading();
            }, 1000);
            
            // Configurar event listeners para filtros
            document.getElementById('searchProducts')?.addEventListener('input', filterProducts);
            document.getElementById('filterCategory')?.addEventListener('change', filterProducts);
            document.getElementById('searchClients')?.addEventListener('input', filterClients);
            
            // Configurar formulários de configurações
            document.getElementById('storeConfigForm')?.addEventListener('submit', saveStoreConfig);
            document.getElementById('paymentConfigForm')?.addEventListener('submit', savePaymentConfig);
        });
        
        // ===== FUNÇÕES DE FILTRO =====
        function filterProducts() {
            const searchTerm = document.getElementById('searchProducts').value.toLowerCase();
            const categoryFilter = document.getElementById('filterCategory').value;
            
            const rows = document.querySelectorAll('#productsTable tr');
            rows.forEach(row => {
                const name = row.cells[1]?.textContent.toLowerCase() || '';
                const category = row.cells[2]?.textContent.toLowerCase() || '';
                
                const matchesSearch = name.includes(searchTerm);
                const matchesCategory = !categoryFilter || category.includes(categoryFilter);
                
                row.style.display = (matchesSearch && matchesCategory) ? '' : 'none';
            });
        }
        
        function filterClients() {
            const searchTerm = document.getElementById('searchClients').value.toLowerCase();
            
            const rows = document.querySelectorAll('#clientsTable tr');
            rows.forEach(row => {
                const name = row.cells[1]?.textContent.toLowerCase() || '';
                const email = row.cells[2]?.textContent.toLowerCase() || '';
                
                const matches = name.includes(searchTerm) || email.includes(searchTerm);
                row.style.display = matches ? '' : 'none';
            });
        }
        
        // ===== FUNÇÃO DE LOGOUT =====
        function logout() {
            // Mostrar confirmação
            if (confirm('Tem certeza que deseja sair do painel administrativo?')) {
                // Mostrar loading
                AdminLoading.showLoading('Saindo...', 'Encerrando sessão administrativa');
                
                // Simular processo de logout
                setTimeout(() => {
                    // Limpar dados da sessão
                    localStorage.removeItem('adminSession');
                    sessionStorage.clear();
                    
                    // Redirecionar para login
                    window.location.href = 'login.html';
                }, 1000);
            }
        }
        
        // ===== FUNÇÕES DE CONFIGURAÇÕES =====
        function saveStoreConfig(e) {
            e.preventDefault();
            
            const config = {
                name: document.getElementById('storeName').value,
                email: document.getElementById('storeEmail').value,
                phone: document.getElementById('storePhone').value,
                address: document.getElementById('storeAddress').value
            };
            
            console.log('Salvando configurações da loja:', config);
            alert('Configurações da loja salvas com sucesso!');
        }
        
        function savePaymentConfig(e) {
            e.preventDefault();
            
            const config = {
                pix: document.getElementById('enablePix').checked,
                card: document.getElementById('enableCard').checked,
                boleto: document.getElementById('enableBoleto').checked,
                deliveryFee: parseFloat(document.getElementById('deliveryFee').value)
            };
            
            console.log('Salvando configurações de pagamento:', config);
            alert('Configurações de pagamento salvas com sucesso!');
        }
    </script>
</body>
</html>
